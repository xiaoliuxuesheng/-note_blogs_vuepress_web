---
title: 第二章 Vue组件化发展
date: 2022-01-01 00:01:03
permalink: /pages/24b6e3/
categories:
  - Vue基础
tags:
  - 
author: 
  name: xiaoliuxuesheng
  link: https://gitee.com/xiaoliuxuesheng
---

## 2.1 Vue安装

### 1. Vue安装-CDN

> Vue是渐进式框架，使用Vue也可以向使用JQuery一样，引入Vue库然后使用Vue相关API

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Vue</title>
    </head>
    <body>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

        <div id="app">{{ message }}</div>

        <script>
            const { createApp } = Vue

            createApp({
                data() {
                    return {
                        message: 'Hello Vue!'
                    }
                }
            }).mount('#app')
        </script>
    </body>
</html>
```

### 2. Vue安装-ES模块化

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Vue</title>
    </head>
    <body>
        <div id="app">{{ message }}</div>

        <script type="module">
            import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'

            createApp({
                data() {
                    return {
                        message: 'Hello Vue!'
                    }
                }
            }).mount('#app')
        </script>
    </body>
</html>
```

> 使用了` <script type="module">`并且导入的 CDN URL 指向的是 Vue 的 ES 模块构建版本。

### 3. Vue安装-导入映射表

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Vue</title>
    </head>
    <body>
        <script type="importmap">
        {
          "imports": {"vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"}
        }
        </script>

        <div id="app">{{ message }}</div>

        <script type="module">
            import { createApp } from 'vue'
            createApp({
                data() {
                    return {
                        message: 'Hello Vue!'
                    }
                }
            }).mount('#app')
        </script>
    </body>
</html>
```

### 4. Vue安装-模块化

1. 将显示内容和数据定义在单独的模块中：component.js，并使用ES模块化语法对外导出

   ```js
   export default {
       data() {
           return { count: 0 }
       },
       template: `<div>count is {{ count }}</div>`
   }
   ```

2. 在index.html中添加外部模块

   ```html
   <!DOCTYPE html>
   <html lang="en">
       <head>
           <title>Vue</title>
       </head>
       <body>
           <div id="app"></div>
           <script type="importmap">
           {
             "imports": {"vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"}
           }
           </script>
           <script type="module">
               import { createApp } from 'vue'
               import MyComponent from './component.js'
               createApp(MyComponent).mount('#app')
           </script>
       </body>
   </html>
   ```

### 5. Vue实例说明

#### a. 应用实例

```js
import { createApp } from 'vue'

const app = createApp({
  /* 根组件选项 */
})
```

> 每个 Vue 应用都是通过 createApp 函数创建一个新的 应用实例

#### b. 根组件

- 传入 `createApp` 的对象实际上是一个组件：这个组件成为根组件，其他组件成为子组件

  ```js
  import { createApp } from 'vue'
  // 从一个单文件组件中导入根组件
  import App from './App.vue'
  
  const app = createApp(App)
  ```

- Vue项目都是由组件数构成：这些组件可嵌套、重用

  ```tex
  App (root component)
  ├─ TodoList
  │  └─ TodoItem
  │     ├─ TodoDeleteButton
  │     └─ TodoEditButton
  └─ TodoFooter
     ├─ TodoClearButton
     └─ TodoStatistics
  ```

#### c. 挂载应用

- 应用实例创建后要渲染到页面区域，需要将应用挂载出来：使用mout函数指定DOM容器

  ```html
  <div id="app"></div>
  <script>
      app.mount('#app')
  </script>
  ```

#### d. 多应用实例

- `createApp` API 允许在同一个页面中创建多个共存的 Vue 应用，而且每个应用都拥有自己的用于配置和全局资源的作用域。

  ```js
  const app1 = createApp({
    /* ... */
  })
  app1.mount('#container-1')
  
  const app2 = createApp({
    /* ... */
  })
  app2.mount('#container-2')
  ```

### 7. Vue安装-Vite

#### a. 安装Node

#### b. 初始化Vue项目

- 命令行执行如下命令

  ```shell
  npm init vue@latest
  ```

  > - 设置安装选项，默认都不设置
  >
  >   ```shell
  >   ✔ Project name: … <your-project-name>
  >   ✔ Add TypeScript? … No / Yes
  >   ✔ Add JSX Support? … No / Yes
  >   ✔ Add Vue Router for Single Page Application development? … No / Yes
  >   ✔ Add Pinia for state management? … No / Yes
  >   ✔ Add Vitest for Unit testing? … No / Yes
  >   ✔ Add an End-to-End Testing Solution? … No / Cypress / Playwright
  >   ✔ Add ESLint for code quality? … No / Yes
  >   ✔ Add Prettier for code formatting? … No / Yes
  >       
  >   Scaffolding project in ./<your-project-name>...
  >   Done.
  >   ```

- Vue项目安装完成

  ```shell
  > cd <your-project-name>
  > npm install
  > npm run dev
  ```

#### c. Vue项目说明

- index.html：引入了src目录下的main.ts

  ```html
  <body>
      <div id="app"></div>
      <script type="module" src="/src/main.ts"></script>
  </body>
  ```

- main.ts：引入样式文件，创建Vue实例挂载到app DOM上

  ```js
  import './assets/main.css'
  
  import { createApp } from 'vue'
  import App from './App.vue'
  
  createApp(App).mount('#app')
  ```

## 2.2 Vue组件化

### 1. 标准Vue组件

```vue
<template>
    <h1>Make me dynamic!{{ param }}</h1>
    <div>
        <button @click="increment">{{ msg }} -- {{ msgAdd }}</button>
    </div>
    <br>
    <div>
        <HelloWorld :msg="msgAdd"/>
    </div>
    <br>
    <div>
    	<slot>默认插槽</slot>
    </div>
</template>

<script lang="ts">
    import HelloWorld from '../HelloWorld.vue'
    export default {
        name: 'Demo01',
        // 组件参数
        props: {
            param: String
        },
        // 组件引用
        components: {
            HelloWorld
        },
        // 变量
        data: () => {
            return {
                msg: 11
            }
        },
        // 方法
        methods: {
            increment () {
                this.msg++
            }
        },
        // 计算属性
        computed: {
            msgAdd(){
                return this.msg + "改成字符串"
            }
        },
        // 回调事件
        emits: ['response'],
        // 监听器
        watch: {
            msg(newValue){
                alert(newValue)
                this.$emit('response',newValue)
            }
        },
    }
</script>
```

### 2. Vue Setup函数

```vue
<template>
<div>
    <h2 @click="countAdd">模板语法</h2>
    <span>{{ count }}</span>
    </div>
<div>
    <h2>Props</h2>
    <span>{{ param }}</span>
    </div>
<div>
    <h2>计算属性</h2>
    <span>{{ countComputer }}</span>
    </div>
<div>
    <h2>监听器 alert</h2>
    </div>
</template>
<script lang="ts">
    import { ref, computed, watch } from 'vue'
    export default {
        name: 'Demo02',
        // 组件参数
        props: {
            param: {
                type: String
            }
        },
        // 事件回调
        emits: ['response'],
        setup(proos, { emit }) {
            // 变量
            let count = ref(1);
            // 方法
            const countAdd = () => {
                count.value = count.value + 1
            }
            // 计算属性
            const countComputer = computed(() => {
                return count.value + 200
            })
            // 监听器
            const countWathch = watch(count, (newVale, oldValue) => {
                alert('count改变：从' + oldValue + '变成了' + newVale)
                emit('response', newVale)
            }, { immediate: true })
            return {
                count,
                countAdd,
                countComputer,
                countWathch
            }
        }
    }
</script>
```

### 3. Vue Setup语法糖

```vue
<template>
<div>
    <h2 @click="countAdd">组件数据</h2>
    <span>{{ count }}</span>
    </div>
<div>
    <h2>组件参数</h2>
    <span>{{ param }}</span>
    </div>
<div>
    <h2>计算属性</h2>
    <span>{{ countComputed }}</span>
    </div>
</template>
<script setup lang="ts">
    import { ref, computed, watch, defineEmits } from 'vue'
    defineProps<{
        param: string
    }>()
    // 数据
    const count = ref<number>(1)
    // 方法
    const countAdd = () => {
        count.value++
    }
    // 计算属性
    const countComputed = computed(() => {
        return count.value + 20
    })
    // 事件回调
    const emit = defineEmits(['response'])
    // 监听器
    watch(count, (newValue, oldValue) => {
        alert('count改变：从' + oldValue + '变成了' + newValue)
        emit('response', newValue)
    })
</script>
```


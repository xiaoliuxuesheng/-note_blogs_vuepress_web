---
title: ViteTs项目搭建_V2
date: 2023-05-17 16:55:04
permalink: /pages/57ef7d/
categories:
  - Vue项目搭建
tags:
  - 
author: 
  name: xiaoliuxuesheng
  link: https://gitee.com/xiaoliuxuesheng
---

## 1.1 环境信息

```shell
$ nvm -v
1.1.10

nrm ls
  npm ---------- https://registry.npmjs.org/
  yarn --------- https://registry.yarnpkg.com/
* tencent ------ https://mirrors.cloud.tencent.com/npm/
  cnpm --------- https://r.cnpmjs.org/
  taobao ------- https://registry.npmmirror.com/
  npmMirror ---- https://skimdb.npmjs.com/registry/

$ node -v
v16.18.1

$ pnpm -v
7.30.0
```

## 1.2 Vue项目搭建

- 使用pnpm工具构建基于Vite的Vue项目

  ```shell
  $ pnpm create vite
  ```

  > ```shell
  > # 定义项目名称：项目根目录名称
  > √ Project name: ... demo03-vite-vue
  > 
  > # 选择项目使用的框架
  > ? Select a framework: » - Use arrow-keys. Return to submit.
  >     Vanilla
  > >   Vue
  >     React
  >     Preact
  >     Lit
  >     Svelte
  >     Others
  >     
  > # 选择框架的语言
  > ? Select a variant: » - Use arrow-keys. Return to submit.
  > >   TypeScript
  >     JavaScript
  >     Customize with create-vue ↗
  >     Nuxt ↗
  >     
  > # 创建成功
  > Done. Now run:
  > 
  >   cd demo03-vite-vue
  >   pnpm install
  >   pnpm run dev
  > ```

## 1.3 项目配置-Eslint

- 下载Eslint源码包

  ```shell
  pnpm add eslint -D
  ```

- 使用Eslint初始化命令构建eslint的配置文件

  ```shell
  pnpm create @eslint/config
  # 或者使用旧版本命
  pnpm eslint --init
  ```

  > ```shell
  > # 选择Eslint的使用方式：①只检查、②检查并定位、③检查定位并且规定代码风格
  > ? How would you like to use ESLint? ...
  >   To check syntax only
  >   To check syntax and find problems
  > > To check syntax, find problems, and enforce code style
  > 
  > # 项目中使用ES的模块应用方式
  > ? What type of modules does your project use? ...
  > > JavaScript modules (import/export)
  >   CommonJS (require/exports)
  >   None of these
  >   
  > # 在Vue框架中使用Eslint
  > ? Which framework does your project use? ...
  >   React
  > > Vue.js
  >   None of these
  >   
  > # YES：Vue项目中使用TS
  > ? Does your project use TypeScript? » No / Yes
  > 
  > # 运行环境：选择浏览器
  > ? Where does your code run? ...  (Press <space> to select, <a> to toggle all, <i> to invert selection)
  > √ Browser
  > √ Node
  > 
  > # Eslint风格：使用流行的
  > ? How would you like to define a style for your project? ...
  > > Use a popular style guide
  >   Answer questions about your style
  >   
  > # 使用标准的规则指导
  > ? Which style guide do you want to follow? ...
  > > Standard: https://github.com/standard/eslint-config-standard-with-typescript
  >   XO: https://github.com/xojs/eslint-config-xo-typescript
  > 
  > # 生成的配置文件格式
  > ? What format do you want your config file to be in? ...
  > > JavaScript
  >   YAML
  >   JSON
  >   
  > # 根据如上各种选项：安装必须的依赖
  > eslint-plugin-vue@latest eslint-config-standard-with-typescript@latest @typescript-eslint/eslint-plugin@^5.43.0 eslint@^8.0.1 eslint-plugin-import@^2.25.2 eslint-plugin-n@^15.0.0 eslint-plugin-promise@^6.0.0 typescript@*
  > ? Would you like to install them now? » No / Yes
  > 
  > # 安装依赖的包管理方式
  > ? Which package manager do you want to use? ...
  >   npm
  >   yarn
  > > pnpm
  > ```

- 项目根目录生成Eslint配置文件：`.eslintrc.cjs`

  ```js
  module.exports = {
      env: {
          browser: true,
          es2021: true
      },
      extends: [
          'plugin:vue/vue3-essential',
          'standard-with-typescript'
      ],
      overrides: [
      ],
      parserOptions: {
          ecmaVersion: 'latest',
          sourceType: 'module'
      },
      plugins: [
          'vue'
      ],
      rules: {
      }
  }
  ```

- Eslint环境启动脚本配置：在`package.json`文件中添加lint启动项

  ```json
  "scripts": {
      "lint": "eslint . --ext .vue,.js,.ts,.jsx,.tsx --fix"
  },
  ```

  > 执行命令：pnpm lint
  >
  > - **问题一（parserOptions.project）**：查看检查结果，查看执行报错信息
  >
  >   ```shell
  >   Error: Error while loading rule '@typescript-eslint/dot-notation': 
  >   You have used a rule which requires parserServices to be generated. 
  >   You must therefore provide a value for the "parserOptions.project" property 
  >   for @typescript-eslint/parser.
  >   Occurred while linting E:\AdminCode\business_alliances\demo03-vite-vue\src\main.ts
  >   ```
  >
  > - 问题一修改（parserOptions.project）：在Eslint配置文件中指定typepscript的配置文件位置
  >
  >   ```json
  >   parserOptions: {
  >       // 默认是当前目录，可以不用添加
  >       tsconfigRootDir: ".",
  >       // 从当前目录读取的ts配置文件路径
  >       project: "./tsconfig.json",
  >   },
  >   ```
  >
  > - **问题二**：再次执行pnpm lint，查看新问题
  >
  >   ```shell
  >   XXX\src\components\HelloWorld.vue
  >     4:29  error  Parsing error: Unexpected token )
  >   ```
  >
  > - 问题二修改：
  >
  >   ```shell
  >   # 下载Eslint的TS解析器
  >   pnpm add -D @typescript-eslint/parser
  >   
  >   # 在Eslint配置文件中添加parserOptions.parse配置
  >   parserOptions: {
  >   	parser: "@typescript-eslint/parser"
  >   }
  >   ```
  >
  > - **问题三**：再次执行pnpm lint，查看新问题
  >
  >   ```shell
  >   Parsing error: ESLint was configured to run on `<tsconfigRootDir>/src\App.vue` using `parserOptions.project`: 
  >   <tsconfigRootDir>/tsconfig.json
  >   The extension for the file (`.vue`) is non-standard. 
  >   You should add `parserOptions.extraFileExtensions` to your config
  >   ```
  >
  > - 问题三修改：根据错误提示，在Eslint配置文件中的parserOptions配置中添加extraFileExtensions属性
  >
  >   ```json
  >   parserOptions: {
  >   	extraFileExtensions: ['.vue'],
  >   }
  >   ```

- Eslint集成Vite项目

  - 下载Eslint的vite插件

    ```shell
    pnpm add -D vite-plugin-eslint
    ```

  - 在Vite配置文件中添加插件

    ```tsx
    import eslintPlugin from 'vite-plugin-eslint'
    
    export default defineConfig({
      plugins: [
        eslintPlugin({
          include: ['src/**/*.ts', 'src/**/*.vue', 'src/*.ts', 'src/*.vue']
        })
      ]
    })
    ```

  - 启动项目`pnpm dev`：在浏览器中提示修改代码中格式问题

## 1.4 配置prettier并集成Eslint

1. 下载prettier相关依赖

   ```shell
   pnpm i -D prettier eslint-config-prettier eslint-plugin-prettier
   ```

   > - prettier：prettier插件的核心代码
   > - eslint-config-prettier：解决ESLint中的样式规范和prettier中样式规范的冲突，以prettier的样式规范为准，使ESLint中的样式规范自动失效
   > - eslint-plugin-prettier：将prettier作为ESLint规范来使用

2. 在项目根目录添加prettier配置文件：`.prettierrc.cjs`

   ```shell
   module.exports = {
       // 一行最多 100 字符
       printWidth: 100,
       // 不使用缩进符，而使用空格
       useTabs: false,
       // 使用 4 个空格缩进
       tabWidth: 4,
       tabSize: 4,
       // 行尾需要有分号
       semi: false,
       // 使用单引号
       singleQuote: true,
       // 对象的 key 仅在必要时用引号
       quoteProps: 'as-needed',
       // jsx 不使用单引号，而使用双引号
       jsxSingleQuote: false,
       // 末尾不需要逗号 'es5'  none
       trailingComma: 'es5',
       // 大括号内的首尾需要空格
       bracketSpacing: true,
       // jsx 标签的反尖括号需要换行
       jsxBracketSameLine: false,
       // 箭头函数，只有一个参数的时候，也需要括号
       arrowParens: 'always',
       // 每个文件格式化的范围是文件的全部内容
       rangeStart: 0,
       rangeEnd: Infinity,
       // 不需要写文件开头的 @prettier
       requirePragma: false,
       // 不需要自动在文件开头插入 @prettier
       insertPragma: false,
       // 使用默认的折行标准
       proseWrap: 'preserve',
       // 根据显示样式决定 html 要不要折行
       htmlWhitespaceSensitivity: 'css',
       // 换行符使用 lf 结尾是 \n \r \n\r auto
       endOfLine: 'lf',
   };
   ```

3. 集成Eslint：添加格式化配置文件之后，需要集成Eslin，将Eslint的检查规则交个格式化方式

   ```json
   module.exports = {
     extends: [
       'plugin:vue/vue3-essential',
       // 集成Eslint检查规则
       'prettier',
       'plugin:prettier/recommended'
     ],
   }
   ```

4. 设置编辑器格式化文件快捷键
   - WebStom：File | Settings | Keymap | Plugins | Prettier | Reformat with Prettier
   - VsCode：
5. 启动项目`pnpm dev`：在浏览器中提示修改代码中格式问题

## 1.5 启动端口配置

